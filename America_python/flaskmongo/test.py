#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @Time : 2019/9/5 17:26
# @Author : chenxin
# @Site : 
# @File : test.py
# @Software: PyCharm
from pymongo import  MongoClient
import json

# jsonData = "[{ 'num': 0, 'mca': 214, 'update_time': '2019-08-14 00:00:24' }, { 'num': 1, 'mca': 42, 'update_time': '2019-08-14 01:00:55' }, { 'num': 2, 'mca': 437, 'update_time': '2019-08-14 02:00:15' }, { 'num': 3, 'mca': 175, 'update_time': '2019-08-14 03:00:19' }, { 'num': 4, 'mca': 31, 'update_time': '2019-08-14 04:00:48' }, { 'num': 5, 'mca': 325, 'update_time': '2019-08-14 05:01:30' }, { 'num': 6, 'mca': 74, 'update_time': '2019-08-14 06:01:16' }, { 'num': 7, 'mca': 137, 'update_time': '2019-08-14 07:01:10' }, { 'num': 8, 'mca': 163, 'update_time': '2019-08-14 08:00:02' }, { 'num': 9, 'mca': 263, 'update_time': '2019-08-14 09:00:47' }, { 'num': 10, 'mca': 342, 'update_time': '2019-08-14 10:01:17' }, { 'num': 11, 'mca': 98, 'update_time': '2019-08-14 11:00:49' }, { 'num': 12, 'mca': 340, 'update_time': '2019-08-14 12:00:43' }, { 'num': 13, 'mca': 227, 'update_time': '2019-08-14 13:01:02' }, { 'num': 14, 'mca': 228, 'update_time': '2019-08-14 14:00:37' }, { 'num': 15, 'mca': 116, 'update_time': '2019-08-14 15:01:24' }, { 'num': 16, 'mca': 405, 'update_time': '2019-08-14 16:01:41' }, { 'num': 17, 'mca': 349, 'update_time': '2019-08-14 17:00:56' }, { 'num': 18, 'mca': 162, 'update_time': '2019-08-14 18:01:58' }, { 'num': 19, 'mca': 428, 'update_time': '2019-08-14 19:01:14' }, { 'num': 20, 'mca': 133, 'update_time': '2019-08-14 20:00:44' }, { 'num': 21, 'mca': 277, 'update_time': '2019-08-14 21:01:33' }, { 'num': 22, 'mca': 74, 'update_time': '2019-08-14 22:00:19' }, { 'num': 23, 'mca': 235, 'update_time': '2019-08-14 23:00:32' }, { 'num': 24, 'mca': 325, 'update_time': '2019-08-15 00:00:11' }, { 'num': 25, 'mca': 260, 'update_time': '2019-08-15 01:01:29' }, { 'num': 26, 'mca': 210, 'update_time': '2019-08-15 02:00:11' }, { 'num': 27, 'mca': 230, 'update_time': '2019-08-15 03:01:21' }, { 'num': 28, 'mca': 66, 'update_time': '2019-08-15 04:00:30' }, { 'num': 29, 'mca': 247, 'update_time': '2019-08-15 05:01:48' }, { 'num': 30, 'mca': 325, 'update_time': '2019-08-15 06:01:50' }, { 'num': 31, 'mca': 425, 'update_time': '2019-08-15 07:01:31' }, { 'num': 32, 'mca': 233, 'update_time': '2019-08-15 08:00:10' }, { 'num': 33, 'mca': 424, 'update_time': '2019-08-15 09:00:21' }, { 'num': 34, 'mca': 90, 'update_time': '2019-08-15 10:00:35' }, { 'num': 35, 'mca': 335, 'update_time': '2019-08-15 11:01:12' }, { 'num': 36, 'mca': 161, 'update_time': '2019-08-15 12:01:52' }, { 'num': 37, 'mca': 102, 'update_time': '2019-08-15 13:00:00' }, { 'num': 38, 'mca': 370, 'update_time': '2019-08-15 14:01:30' }, { 'num': 39, 'mca': 263, 'update_time': '2019-08-15 15:00:24' }, { 'num': 40, 'mca': 308, 'update_time': '2019-08-15 16:00:44' }, { 'num': 41, 'mca': 262, 'update_time': '2019-08-15 17:01:27' }, { 'num': 42, 'mca': 106, 'update_time': '2019-08-15 18:01:17' }, { 'num': 43, 'mca': 139, 'update_time': '2019-08-15 19:00:53' }, { 'num': 44, 'mca': 174, 'update_time': '2019-08-15 20:00:38' }, { 'num': 45, 'mca': 54, 'update_time': '2019-08-15 21:01:51' }, { 'num': 46, 'mca': 79, 'update_time': '2019-08-15 22:00:16' }, { 'num': 47, 'mca': 149, 'update_time': '2019-08-15 23:01:23' }, { 'num': 48, 'mca': 168, 'update_time': '2019-08-16 00:01:41' }, { 'num': 49, 'mca': 56, 'update_time': '2019-08-16 01:00:20' }, { 'num': 50, 'mca': 229, 'update_time': '2019-08-16 02:01:14' }, { 'num': 51, 'mca': 257, 'update_time': '2019-08-16 03:01:50' }, { 'num': 52, 'mca': 203, 'update_time': '2019-08-16 04:01:05' }, { 'num': 53, 'mca': 198, 'update_time': '2019-08-16 05:00:33' }, { 'num': 54, 'mca': 425, 'update_time': '2019-08-16 06:01:24' }, { 'num': 55, 'mca': 196, 'update_time': '2019-08-16 07:00:34' }, { 'num': 56, 'mca': 193, 'update_time': '2019-08-16 08:01:11' }, { 'num': 57, 'mca': 257, 'update_time': '2019-08-16 09:00:43' }, { 'num': 58, 'mca': 219, 'update_time': '2019-08-16 10:00:35' }, { 'num': 59, 'mca': 61, 'update_time': '2019-08-16 11:01:30' }, { 'num': 60, 'mca': 134, 'update_time': '2019-08-16 12:01:23' }, { 'num': 61, 'mca': 277, 'update_time': '2019-08-16 13:00:05' }, { 'num': 62, 'mca': 434, 'update_time': '2019-08-16 14:00:39' }, { 'num': 63, 'mca': 102, 'update_time': '2019-08-16 15:01:00' }, { 'num': 64, 'mca': 300, 'update_time': '2019-08-16 16:01:58' }, { 'num': 65, 'mca': 28, 'update_time': '2019-08-16 17:00:19' }, { 'num': 66, 'mca': 200, 'update_time': '2019-08-16 18:01:28' }, { 'num': 67, 'mca': 200, 'update_time': '2019-08-16 19:00:44' }, { 'num': 68, 'mca': 243, 'update_time': '2019-08-16 20:01:36' }, { 'num': 69, 'mca': 354, 'update_time': '2019-08-16 21:01:23' }, { 'num': 70, 'mca': 224, 'update_time': '2019-08-16 22:00:40' }, { 'num': 71, 'mca': 201, 'update_time': '2019-08-16 23:01:09' }, { 'num': 72, 'mca': 80, 'update_time': '2019-08-17 00:00:39' }, { 'num': 73, 'mca': 350, 'update_time': '2019-08-17 01:01:02' }, { 'num': 74, 'mca': 199, 'update_time': '2019-08-17 02:01:34' }, { 'num': 75, 'mca': 34, 'update_time': '2019-08-17 03:00:06' }, { 'num': 76, 'mca': 235, 'update_time': '2019-08-17 04:01:41' }, { 'num': 77, 'mca': 70, 'update_time': '2019-08-17 05:00:19' }, { 'num': 78, 'mca': 233, 'update_time': '2019-08-17 06:01:38' }, { 'num': 79, 'mca': 409, 'update_time': '2019-08-17 07:01:12' }, { 'num': 80, 'mca': 116, 'update_time': '2019-08-17 08:01:26' }, { 'num': 81, 'mca': 292, 'update_time': '2019-08-17 09:00:54' }, { 'num': 82, 'mca': 249, 'update_time': '2019-08-17 10:01:42' }, { 'num': 83, 'mca': 440, 'update_time': '2019-08-17 11:00:56' }, { 'num': 84, 'mca': 64, 'update_time': '2019-08-17 12:01:26' }, { 'num': 85, 'mca': 388, 'update_time': '2019-08-17 13:01:16' }, { 'num': 86, 'mca': 109, 'update_time': '2019-08-17 14:01:17' }, { 'num': 87, 'mca': 211, 'update_time': '2019-08-17 15:00:58' }, { 'num': 88, 'mca': 111, 'update_time': '2019-08-17 16:00:49' }, { 'num': 89, 'mca': 385, 'update_time': '2019-08-17 17:00:34' }, { 'num': 90, 'mca': 443, 'update_time': '2019-08-17 18:00:21' }, { 'num': 91, 'mca': 317, 'update_time': '2019-08-17 19:00:51' }, { 'num': 92, 'mca': 108, 'update_time': '2019-08-17 20:01:48' }, { 'num': 93, 'mca': 87, 'update_time': '2019-08-17 21:00:55' }, { 'num': 94, 'mca': 185, 'update_time': '2019-08-17 22:01:34' }, { 'num': 95, 'mca': 64, 'update_time': '2019-08-17 23:00:58' }, { 'num': 96, 'mca': 289, 'update_time': '2019-08-18 00:00:28' }, { 'num': 97, 'mca': 428, 'update_time': '2019-08-18 01:00:41' }, { 'num': 98, 'mca': 105, 'update_time': '2019-08-18 02:01:18' }, { 'num': 99, 'mca': 277, 'update_time': '2019-08-18 03:00:58' }, { 'num': 100, 'mca': 90, 'update_time': '2019-08-18 04:00:28' }, { 'num': 101, 'mca': 38, 'update_time': '2019-08-18 05:01:59' }, { 'num': 102, 'mca': 297, 'update_time': '2019-08-18 06:00:51' }, { 'num': 103, 'mca': 72, 'update_time': '2019-08-18 07:00:03' }, { 'num': 104, 'mca': 360, 'update_time': '2019-08-18 08:00:25' }, { 'num': 105, 'mca': 356, 'update_time': '2019-08-18 09:01:59' }, { 'num': 106, 'mca': 284, 'update_time': '2019-08-18 10:01:35' }, { 'num': 107, 'mca': 60, 'update_time': '2019-08-18 11:01:45' }, { 'num': 108, 'mca': 99, 'update_time': '2019-08-18 12:01:30' }, { 'num': 109, 'mca': 314, 'update_time': '2019-08-18 13:01:02' }, { 'num': 110, 'mca': 426, 'update_time': '2019-08-18 14:01:57' }, { 'num': 111, 'mca': 62, 'update_time': '2019-08-18 15:01:14' }, { 'num': 112, 'mca': 251, 'update_time': '2019-08-18 16:00:54' }, { 'num': 113, 'mca': 286, 'update_time': '2019-08-18 17:00:49' }, { 'num': 114, 'mca': 129, 'update_time': '2019-08-18 18:00:55' }, { 'num': 115, 'mca': 127, 'update_time': '2019-08-18 19:00:04' }, { 'num': 116, 'mca': 126, 'update_time': '2019-08-18 20:00:21' }, { 'num': 117, 'mca': 333, 'update_time': '2019-08-18 21:00:12' }, { 'num': 118, 'mca': 239, 'update_time': '2019-08-18 22:00:44' }, { 'num': 119, 'mca': 387, 'update_time': '2019-08-18 23:01:39' }, { 'num': 120, 'mca': 290, 'update_time': '2019-08-19 00:01:58' }, { 'num': 121, 'mca': 256, 'update_time': '2019-08-19 01:00:42' }, { 'num': 122, 'mca': 416, 'update_time': '2019-08-19 02:01:06' }, { 'num': 123, 'mca': 378, 'update_time': '2019-08-19 03:01:22' }, { 'num': 124, 'mca': 43, 'update_time': '2019-08-19 04:00:43' }, { 'num': 125, 'mca': 278, 'update_time': '2019-08-19 05:00:30' }, { 'num': 126, 'mca': 67, 'update_time': '2019-08-19 06:01:05' }, { 'num': 127, 'mca': 144, 'update_time': '2019-08-19 07:01:51' }, { 'num': 128, 'mca': 221, 'update_time': '2019-08-19 08:01:20' }, { 'num': 129, 'mca': 66, 'update_time': '2019-08-19 09:01:15' }, { 'num': 130, 'mca': 123, 'update_time': '2019-08-19 10:01:04' }, { 'num': 131, 'mca': 49, 'update_time': '2019-08-19 11:00:54' }, { 'num': 132, 'mca': 103, 'update_time': '2019-08-19 12:01:54' }, { 'num': 133, 'mca': 239, 'update_time': '2019-08-19 13:01:21' }, { 'num': 134, 'mca': 371, 'update_time': '2019-08-19 14:01:11' }, { 'num': 135, 'mca': 158, 'update_time': '2019-08-19 15:00:18' }, { 'num': 136, 'mca': 31, 'update_time': '2019-08-19 16:00:39' }, { 'num': 137, 'mca': 354, 'update_time': '2019-08-19 17:00:18' }, { 'num': 138, 'mca': 243, 'update_time': '2019-08-19 18:01:55' }, { 'num': 139, 'mca': 411, 'update_time': '2019-08-19 19:01:02' }, { 'num': 140, 'mca': 111, 'update_time': '2019-08-19 20:00:21' }, { 'num': 141, 'mca': 359, 'update_time': '2019-08-19 21:01:36' }, { 'num': 142, 'mca': 44, 'update_time': '2019-08-19 22:00:28' }, { 'num': 143, 'mca': 127, 'update_time': '2019-08-19 23:00:51' }, { 'num': 144, 'mca': 415, 'update_time': '2019-08-20 00:01:29' }, { 'num': 145, 'mca': 368, 'update_time': '2019-08-20 01:01:22' }, { 'num': 146, 'mca': 390, 'update_time': '2019-08-20 02:00:17' }, { 'num': 147, 'mca': 189, 'update_time': '2019-08-20 03:01:14' }, { 'num': 148, 'mca': 75, 'update_time': '2019-08-20 04:00:24' }, { 'num': 149, 'mca': 125, 'update_time': '2019-08-20 05:00:54' }, { 'num': 150, 'mca': 94, 'update_time': '2019-08-20 06:01:06' }, { 'num': 151, 'mca': 90, 'update_time': '2019-08-20 07:01:25' }, { 'num': 152, 'mca': 288, 'update_time': '2019-08-20 08:01:33' }, { 'num': 153, 'mca': 156, 'update_time': '2019-08-20 09:00:12' }, { 'num': 154, 'mca': 312, 'update_time': '2019-08-20 10:01:46' }, { 'num': 155, 'mca': 215, 'update_time': '2019-08-20 11:00:54' }, { 'num': 156, 'mca': 385, 'update_time': '2019-08-20 12:01:40' }, { 'num': 157, 'mca': 166, 'update_time': '2019-08-20 13:01:53' }, { 'num': 158, 'mca': 424, 'update_time': '2019-08-20 14:01:28' }, { 'num': 159, 'mca': 450, 'update_time': '2019-08-20 15:01:50' }, { 'num': 160, 'mca': 339, 'update_time': '2019-08-20 16:00:12' }, { 'num': 161, 'mca': 300, 'update_time': '2019-08-20 17:01:14' }, { 'num': 162, 'mca': 266, 'update_time': '2019-08-20 18:01:07' }, { 'num': 163, 'mca': 63, 'update_time': '2019-08-20 19:01:49' }, { 'num': 164, 'mca': 328, 'update_time': '2019-08-20 20:01:45' }, { 'num': 165, 'mca': 44, 'update_time': '2019-08-20 21:00:19' }, { 'num': 166, 'mca': 344, 'update_time': '2019-08-20 22:01:30' }, { 'num': 167, 'mca': 33, 'update_time': '2019-08-20 23:01:56' }, { 'num': 168, 'mca': 255, 'update_time': '2019-08-21 00:01:59' }, { 'num': 169, 'mca': 65, 'update_time': '2019-08-21 01:00:30' }, { 'num': 170, 'mca': 224, 'update_time': '2019-08-21 02:01:50' }, { 'num': 171, 'mca': 286, 'update_time': '2019-08-21 03:00:06' }, { 'num': 172, 'mca': 180, 'update_time': '2019-08-21 04:01:40' }, { 'num': 173, 'mca': 96, 'update_time': '2019-08-21 05:01:57' }, { 'num': 174, 'mca': 291, 'update_time': '2019-08-21 06:00:23' }, { 'num': 175, 'mca': 294, 'update_time': '2019-08-21 07:00:46' }, { 'num': 176, 'mca': 137, 'update_time': '2019-08-21 08:01:59' }, { 'num': 177, 'mca': 398, 'update_time': '2019-08-21 09:00:07' }, { 'num': 178, 'mca': 448, 'update_time': '2019-08-21 10:01:30' }, { 'num': 179, 'mca': 154, 'update_time': '2019-08-21 11:01:43' }, { 'num': 180, 'mca': 181, 'update_time': '2019-08-21 12:00:30' }, { 'num': 181, 'mca': 404, 'update_time': '2019-08-21 13:00:16' }, { 'num': 182, 'mca': 286, 'update_time': '2019-08-21 14:01:59' }, { 'num': 183, 'mca': 239, 'update_time': '2019-08-21 15:01:07' }, { 'num': 184, 'mca': 232, 'update_time': '2019-08-21 16:01:45' }, { 'num': 185, 'mca': 142, 'update_time': '2019-08-21 17:01:04' }, { 'num': 186, 'mca': 162, 'update_time': '2019-08-21 18:00:27' }, { 'num': 187, 'mca': 348, 'update_time': '2019-08-21 19:01:52' }, { 'num': 188, 'mca': 252, 'update_time': '2019-08-21 20:00:20' }, { 'num': 189, 'mca': 385, 'update_time': '2019-08-21 21:00:59' }, { 'num': 190, 'mca': 175, 'update_time': '2019-08-21 22:00:25' }, { 'num': 191, 'mca': 220, 'update_time': '2019-08-21 23:01:03' }, { 'num': 192, 'mca': 394, 'update_time': '2019-08-22 00:00:20' }, { 'num': 193, 'mca': 127, 'update_time': '2019-08-22 01:00:41' }, { 'num': 194, 'mca': 272, 'update_time': '2019-08-22 02:01:40' }, { 'num': 195, 'mca': 158, 'update_time': '2019-08-22 03:01:34' }, { 'num': 196, 'mca': 310, 'update_time': '2019-08-22 04:01:06' }, { 'num': 197, 'mca': 104, 'update_time': '2019-08-22 05:01:24' }, { 'num': 198, 'mca': 316, 'update_time': '2019-08-22 06:00:41' }, { 'num': 199, 'mca': 185, 'update_time': '2019-08-22 07:01:55' }]"
# b=jsonData.replace("'",'"')
# a=json.loads(b)
# for i in a:
#     print(i)
#client = MongoClient('mongodb://127.0.0.1:27017') #//连接方式1
client = MongoClient('127.0.0.1',27017)

#获取所有的数据库
dblist=client.list_database_names()
print(dblist)

db = client['school']
#获取所有数据库的集合
collections = db.collection_names()
print(collections)

student = db.student
print(student)

doc = {
    'author':'liu',
    'text':'nothing',
    'tags':['python','mongo']
}
#成功插入了一个id,并返回了自动生成的id
#id = student.insert(doc)
#print(id)

new_doc = [
    {'_id':10,'author':'wang'},
    {'_id': 100, 'title': 'mongo'},

]

#id = student.insert(new_doc) #插入
#print(id)

# id=student.delete_one({'author':'wang'})
# print(id)

#a = student.update_one({'title':'mongo'},{'$set':{'title':'python'}})
#print(a)

c = student.find()
print(c)
for i in c:
    print(i)
